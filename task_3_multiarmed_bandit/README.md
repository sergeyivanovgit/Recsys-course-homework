# Домашняя работа 3 (5 баллов)
## Дедлайн
Работы принимаются до **06.12.2022 12:00 (вторник)**.

## Требования
Работа должна быть выполнена на языке Python (версия не менее 3.6). Код должен быть написан аккуратно и читаемо, названия переменных должны отражать свою суть. Так же следует оставлять пояснения к своим подходам к решению.

Результат работы - ноутбук с вызываемым рабочим кодом и **комментариями-пояснениями**. Весь код должен быть закоммичен и создан Pull Request. В чате телеграма **нужно отметить @e_sheina и написать**, что Ваш PR готов к проверке и прислать ссылку на PR. Так же необходимо проставить 2 хеш-тега: #HW3 #Фамилия

## Отправка ДЗ
Репозиторий: https://github.com/SheinaEkaterina/Recsys-course-homework_2022

Правила именования PR:
- HW3: фамилия.первая_буква_имени (например, HW3: ivanov.s)

Правила именования ноутбуков: 
- В папке task_3_multiarmed_bandit должен быть результирующий ноутбук, названный HW3.ipynb, и необходимые скрипты для решения.

## Описание
В файле **sim_lib.py** лежит функция *simulation* которая производит симуляцию жизненного цикла баннеров(Mortal bandits), на некотором абстрактном траффике. Ей на вход подается *policy* и *n* кол-во итераций.  *Policy* это функция со следующей спецификацией: 
* на вход получает лог исторических наблюдений. Это пандас датафрейм, где каждая строка соответствует статистике по одному баннеру, а индекс датафрейма, это номер этого баннера.
* на выходе выдает индекс в датафрейме отвечающий баннеру, который надо выбрать в текущей итерации. 

В результате работы *simulation* возвращает кумулятивны regret данного полиси при симуляции за *n* шагов. Пример использования симулятора для *e-greedy* бандита находится в ноутбуке **task3_example.ipynb**.
## Использование
В ноутбуке task3_example.ipynb есть сид и бейзлайн регрет для вашей задачи. Необходимо сделать:
 - Написать свое policy, функцию, которая работает согласно спецификации выше. Важно, чтобы это была не e-greedy, а иная полиси(UCB, Thompson sampling или что-то другое)
 - Прогнать свое полиси через *simulation* при  *n*=200k и фиксированном сиде из task3_example.
 - Оптимизировать свое policy так, чтобы общий регрет был ниже того, который выдает полиси из task3_example.
 - Затюнить в своем полиси баланс exploration/exploitation так, чтобы минимизировать регрет при данном сиде.